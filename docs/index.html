<!doctype html>
<html class="no-js" lang="es-DO">

<head>
	<meta charset="utf-8">
	<meta name="google" content="notranslate" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Proyecto escuelaRD</title>
	<meta name="description" content="Proyecto escuelaRD - Herramienta de manejo y publicaci&oacute;n de calificaciones escolares seg&uacute;n el modelo de la Rep&uacute;blica Dominicana">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="MobileOptimized" content="width">
	<meta name="HandheldFriendly" content="true">
	<meta property="og:title" content="Proyecto escuelaRD" />
	<meta property="og:type" content="article" />
	<meta property="og:image" content="https://imagenes.escuelard.com/logo2.svg" />
	<meta property="og:url" content="https://escuelard.com" />
	<meta property="og:site-name" content="escuelaRD.com" />
	<meta property="og:description" content="Proyecto escuelaRD - Herramienta de manejo y publicaci&oacute;n de calificaciones escolares seg&uacute;n el modelo de la Rep&uacute;blica Dominicana" />

	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<link rel="icon" type="image/x-icon" href="https://imagenes.escuelard.com/favicons/favicon.png" />
	<link rel="apple-touch-icon" sizes="57x57" href="https://imagenes.escuelard.com/favicons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="https://imagenes.escuelard.com/favicons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="https://imagenes.escuelard.com/favicons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="https://imagenes.escuelard.com/favicons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="https://imagenes.escuelard.com/favicons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="https://imagenes.escuelard.com/favicons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="https://imagenes.escuelard.com/favicons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="https://imagenes.escuelard.com/favicons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="https://imagenes.escuelard.com/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192" href="https://imagenes.escuelard.com/favicons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://imagenes.escuelard.com/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="https://imagenes.escuelard.com/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://imagenes.escuelard.com/favicons/favicon-16x16.png">
	<link rel="manifest" href="manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="https://imagenes.escuelard.com/favicons/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
<style>
	
.registro_circulo{
	stroke-dasharray: 166;
	stroke-dashoffset: 166;
	stroke-width: 2;
	stroke-miterlimit: 10;
	stroke: #7ac142;
	fill: none;
	animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) forwards;
}
.registro, .registro_ex{
	border-radius: 50%;
	display: block;
	stroke-width: 6;
	stroke-miterlimit: 10;
	margin: 1% auto;
	box-shadow: inset 0px 0px 0px #7ac142;
}
.registro{
	stroke: blue;
	animation: fill .2s ease-in-out .2s forwards, scale .2s ease-in-out .5s both;
}

.registro_insertado{
	transform-origin: 50% 50%;
	stroke-dasharray: 48;
	stroke-dashoffset: 48;
	animation: stroke 0.2s cubic-bezier(0.45, 0, 0.45, 1) 0.4s forwards;
}
@keyframes stroke{
	100%{
		stroke-dashoffset: 0;
	}
}
@keyframes scale{
	0%, 100%{
		transform:none;
	}
	50%{
		transform:scale3d(1.1, 1.1, 1);
	}
}
@keyframes fill{
	100%{
		box-shadow: inset 0px 0px 0px 30px #7ac142;
	}
}
@keyframes reg{
	100%{
		box-shadow:inset 0px 0px 0px 20px #ff9800;
	}
}
@keyframes noid{
	100%{
		box-shadow:inset 0px 0px 0px 20px #f14753;
	}
}
</style>
</head>

<body oncontextmenu="return false;">

	<div class="content bg-dark" id="visor-huellimetro" style="height:100vh;overflow-y:hidden;display: none;">

		<div class="animated fadeIn d-flex justify-content-center align-items-center" style="height: 100%;">

			<div class="card border mx-3" style="width: 900px;">
				<div class="card-body p-0 m-0">

                    			
						<div class="border p-0 m-0">
							<input style="font-size:2.2rem" class="form-control border-0 font-weight-bold w-100 bg-white" value="Sistema de asistencia por huella dactilar." type="text" id="nombre" autocomplete="off" readonly="">
                    		<input style="font-size:1.1rem" class="p-0 m-0 pr-2 border-0 font-weight-bold w-100 bg-white text-right" value="Proyecto escuelaRD" type="text" id="curso" autocomplete="off" readonly="">
					</div>

					<div class="row p-0 m-0">
						<div class="border col-md-4">

							<div class="card border p-0 border-primary">
								<div class="card-body p-0 text-center">
									
									  
										<div class="stat-content p-0">
											
												<div class="stat-text">
													<img src="https://imagenes.escuelard.com/logo2.svg" style="width:220px;height:220px;border: 6px solid orange;" class="my-2 rounded-circle" id="foto">
												</div>
	<div style="font-size:1.8rem" id="reloj-digital" class="font-weight-bold my-3">01:21:59 A.M.</div> 
										</div>
								</div>
							</div>

						</div>
					<div class="border col-md-6">
						
						<div class="m-0 mt-1 p-0 rounded border border-danger">
                                
							<div style="width: 233px;height: 233px;" id="registro"></div>

				</div>
				<audio class="d-none" style="display:none" id="audio_registro" controls><source type="audio/mp3" src="https://cdn.escuelard.com/assets/sound/asistencias.mp3"></audio>
				<audio class="d-none" style="display:none" id="audio_no_registro" controls><source type="audio/mp3" src="https://cdn.escuelard.com/assets/sound/no-asistencias.mp3"></audio>
					</div>
					<div class="border col-md-2">
						<div class="border rounded border-success text-center">
                            <div class=""><img src="https://imagenes.escuelard.com/huella.png" style="width:80px" />
                                         <strong style="font-size: 1.4rem">Coloque su dedo</strong>
                                         <div>
										 <img src="https://imagenes.escuelard.com/flecha.gif" style="width:70px;height:70px;" alt="Flecha abajo">
										</div>
										<div>
										<img src="https://imagenes.escuelard.com/huellimetro.jpg" style="width:100px" />
									</div>
										
                                </div>


					</div>

				</div>




				</div>
				<div class="my-4 row"><div class="col-5 text-center"><a href="#a" onclick="javascript:location.reload();"><img title="Click para recargar" alt="Recargar" src="https://imagenes.escuelard.com/recargar.png"></a></div><div class="col-6 text-right m-0 p-0"><a id="copy" href="https://escuelard.edu.do">&copy; 2024 Proyecto escuelaRD</a></div></div>

			</div>
		</div>
	</div>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>

	<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getDatabase, query, ref, onValue, orderByValue, limitToLast, set} from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, setPersistence, browserLocalPersistence, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

$(document).ready(function() {

const firebaseConfig = {
    apiKey: "AIzaSyDQmWuKzpuupSMNwp1UNqsIoLL2-5FuZ7o",
  authDomain: "asistencias-escuelard.firebaseapp.com",
  databaseURL: "asistencias-escuelard-default-rtdb.firebaseio.com",
  projectId: "asistencias-escuelard",
  storageBucket: "asistencias-escuelard.firebasestorage.app",
  messagingSenderId: "280871850687",
  appId: "1:280871850687:web:2d85833ac756f24476ac0a"
    
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

	const provider = new GoogleAuthProvider();
	const auth = getAuth();

	try {
		onAuthStateChanged(auth, userInfo => {
			if (userInfo) {

$('#visor-huellimetro').show();

        onValue(ref(database, 'profesores/' + btoa(userInfo.email)), (snapshot) => {
		const eh = snapshot.val().split('-');
		onValue(ref(database, 'no_registro/' + eh[0] + '/' + eh[2]), (nosnapshot) => {
					if(nosnapshot.val() != null){
						if(nosnapshot.val() == 0){
							MostrarDatos('Sistema de asistencia por huella dactilar.', 'Proyecto escuelaRD', 'https://imagenes.escuelard.com/logo2.svg', 0);
						}else{
						const idtime = nosnapshot.val().split('-');
						onValue(ref(database, eh[0] + '/usuarios/' + idtime[0]), (snapshot) => {
				
			MostrarDatos(snapshot.val().datos, snapshot.val().curso, snapshot.val().foto, 2, idtime[1]);
				
    		}, { onlyOnce: true });
					}
				}
		});
		onValue(ref(database, eh[0] + '/huellimetros/' +  eh[2]), (snapshot) => {
		onValue(query(ref(database, eh[0] + '/asistencias/' + eh[3] + '-' +  eh[4] + '/' + snapshot.val() + '/' + (new Date().getMonth() + 1) + '/' + new Date().getDate()), orderByValue(), limitToLast(1)), (idsnapshot) => {
	
			onValue(ref(database, eh[0] + '/usuarios/' + Object.keys(idsnapshot.val())[0]), (snapshot) => {
			
			MostrarDatos(snapshot.val().datos, snapshot.val().curso, snapshot.val().foto, 1, Object.values(idsnapshot.val())[0]);
				
    		}, { onlyOnce: true });
	});
    }, { onlyOnce: true });
    }, { onlyOnce: true });


	function MostrarDatos(nombre, curso, foto, r=0, hora=''){
				$('#nombre').val(nombre);
				setTimeout(() => {
					$('#nombre').each(function() {
					var $this = $(this);
					var text = $this.val();
					$this.val('');
					var i = 0;
					var typingEffect = setInterval(function() {
						$this.val($this.val() + text.charAt(i));
						i++;
						if (i > text.length) {
							clearInterval(typingEffect);
						}
					}, 14);
				});
				}, 200);
				$('#curso').val(curso);
				$('#foto').attr('src', foto);
				
				if(r == 1){
					$('#registro').parent().html('<div id="registro"></div>');
					$('#audio_registro').get(0).play();
					$('#registro').parent().html('<svg style="width: 233px;height: 233px;" id="registro" class="registro" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="registro_circulo" cx="26" cy="26" r="25" fill="none" /><path class="registro_insertado" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" /></svg><div style="display:block;font-weight:bold;text-align:center;font-size:1.5rem">&iexcl;Asistencia registrada!<br /><strong style="display:block;font-size:1.5rem">' + TimeStamptoHour(hora) + '</strong><br /></div>');
				}else if(r == 2){
					$('#registro').parent().html('<div id="registro"></div>');
					$('#audio_no_registro').get(0).play();
					
					$('#registro').parent().html('<div id="registro" class="text-center" style="animation: reg .2s ease-in-out .2s forwards, scale .2s ease-in-out .5s both;"><br /><img src="https://imagenes.escuelard.com/registrado.png" /><br /><strong class="text-warning display-4 d-block font-weight-bold">&iexcl;Ya se ha registrado!</strong><br /><strong style="display:block;font-size:1.5rem">' + TimeStamptoHour(hora) + '</strong><br /></div>');
				}else{
					$('#registro').parent().html('<div id="registro"></div>');
					$('#audio_no_registro').get(0).play();
					$('#registro').parent().html('<div id="registro" style="animation: noid .2s ease-in-out .2s forwards, scale .2s ease-in-out .5s both;" class="text-center"><br /><br /><img src="https://imagenes.escuelard.com/no-registrado.png" /><br /><strong class="text-danger display-4">&iexcl;No se pudo registrar!</strong><br /><br /><br /></div>');
				}
	}

	function TimeStamptoHour(hora){
					var date = new Date(hora * 1000);
					var hours = date.getHours();
					var minutes = date.getMinutes();
					var ampm = hours >= 12 ? 'p.m.' : 'a.m.';
					hours = hours % 12;
					hours = hours ? hours : 12;
					minutes = minutes < 10 ? '0' + minutes : minutes;
		return hours + ':' + minutes + ' ' + ampm;
	}

  Reloj();
  setInterval(Reloj, 1000);
	

function Reloj() {
	var f = new Date();  
  function ConCero(x) {
    if (x < 10) {
      return x = '0' + x;
    } else {
      return x;
    }
  }

  function Formato12(x) {
    if (x > 12) {
      return x = x - 12;
    } else if (x == 0) {
      return x = 12;
    } else {
      return x;
    }
  }
  
  function Meridiano() {
	  var m = 'a.m.';
	  var x = f.getHours();
	  if(x == 12 && f.getMinutes() == 0){
			return m = 'm.';
	  } else if (x == 12 || x > 12) {
	      return m = 'p.m.';
	  } else {
	      return m;
	  }
  }

  var h = ConCero(Formato12(f.getHours()));
  var m = ConCero(f.getMinutes());
  var s = ConCero(f.getSeconds());
  var me = Meridiano();

  $('#reloj-digital').text(h + ':' + m + ':' + s + ' ' + me)

}
	} else {
		$('#visor-huellimetro').hide();
		setPersistence(auth, browserLocalPersistence).then(function () {
		return signInWithPopup(auth, provider).then(() => {
		})
			.catch(err => {
				$('#visor-huellimetro').hide();
			});
	});
	}
});
} catch (error) {
	$('#visor-huellimetro').hide();
}
	
var f = new Date();
var a = f.getFullYear();  
document.getElementById("copy").innerHTML = '&copy; ' + a + ' Proyecto escuelaRD';

$(document).on('click', 'body', function () {
	var requestMethod = document.body.requestFullScreen || document.body.webkitRequestFullScreen || document.body.mozRequestFullScreen || document.body.msRequestFullScreen;
		if(requestMethod){
			requestMethod.call(document.body);
		}else if (typeof window.ActiveXObject !== "undefined"){
			var wscript = new ActiveXObject("WScript.Shell");
			if(wscript !== null){
				wscript.SendKeys("{F11}");
			}
    }
});



});
	


		if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./pwa.js');
     // .then(reg => console.log('Registro de SW exitoso', reg))
   //   .catch(err => console.warn('Error al tratar de registrar el SW', err))
}
	</script>
</body>

</html>
